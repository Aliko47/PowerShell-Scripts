$hostname = Hostname
$token = ""

$all_hosts = @("RUDOM007", "RUDOM009", "RUDOM015", "RUDOM031", "RUDOM100", "RUDOM105", "RUDOM125", "RUDOM129", "RUDOM131", "RUDOM136", "RUDOM139", "RUDOM143", "RUDOM148",
"RUDOM149", "RUDOM150", "RUDOM151", "RUDOM153", "RUDOM158", "RUDOM171", "RUDOM174", "RUDOM177", "RUDOM186", "RUDOM201", "RUDOM203", "RUDOM205", "RUDOM216",
"RUDOM223", "RUDOM239", "RUDOM310", "RUDOM430", "RUDOM460", "RUDOM911", "RUDOM916", "RUDOM917", "RUDOM921", "RUDOM923", "RUDOMCASH10", "RUDOMPRINTSRV01", "RUHQOMNI",
"RUMCD004", "RUMCD013", "RUMCD016", "RUMCD019", "RUMCD027", "RUMCD036", "RUMCD048", "RUMCD051", "RUMCD911", "RUMCDPRINTSRV01", "RUMCDTENDER", "RUMND001", "RUMND002",
"RUMND005", "RUMND006", "RUMNDCASH18", "RUMWD001", "RUMWDCASH20", "RUSPB008", "RUSPB030", "RUSPB225", "RUSPBPRINTSRV01", "RUVID007", "RUVID043", "RUVID050", "RUVID055",
"RUVID075", "RUVID082", "RUVID098", "RUVID105", "RUVID114", "RUVID116", "RUVID130", "RUVID135", "RUVID151", "DESCCMTESTVM200")

$all_tokens = @("ed1f0520c693ca2498e1f8eb5411ca68a4b11196e2ff3521a3d800b2a0e0e093", "d5f5fcabfb418430efdbc6274cc82a7ca4eb4c6e80520e973dc5cb5e26f82e35", "48e643078ad8a2a597b203748adbdfef7166188f6f5ca4b44033edcc7cf1bbf1",
"383bbf1c1f986ea82f4177e14cd51e8719da60eefa5ddec2a587c67cf904d161", "bb2a1379b4bcde22e3e135f1c9f4b76e24a453694167e8fb9ae635b2bad80dc0", "3e15dd57398e312cae5c268b9ebb588e5f78152fb01690a57393dd719bef01ab", 
"a2ea756f3c6cf5bf1a5da0c7f44ea1bcb4691a28e7a5783296a724505f8241ac", "94d80f552b15d2b7c604bee61568f37fe63fe3a801c55bed91476bb4ec305e33", "4b53834e3425f9f18a2c0931f12da750603a9332a78ba03c2063bc10c9faa916", 
"837ef8e2067494c75e15df5629d6c8f60fa11354577164da00de33b7b2c7e57c", "c3e6d9036f8783e4537b160245c01cb1a6b24b39f3811d6724050b4f1a864c6a", "1d3cf5de12a2bef5cfe89f48023292839ba93ffdc1baf44508e594d9c67c4626",
"b05bea6b23fd4cbb0c1559ec6cd9bc3dfca8ead5d815b3aa0b5d1e78e198c01e", "08c847912cf39d87be28b023d0de1023ed347847b562e5c07151bbe9cc4b696c", "61935bf08a13b735e731b8bf3f4cf31ad6d7fda7ea93625446a5cda547e2d61c",
"8dcb35ceca85a3428c216ab7fd1fb56d114343c4129901d6cdc4f3b075105c8e", "72cac448f20d45d084c8af42d047691bdca93a50b63d1513620ecb8e1b84c981", "75bbc3c8b4971bff5045867d4bfbb1b6aedaaf2b4a2b0dadc2ee97d739c9fcd8",
"823df75105c1146941be7801db74280d14976be6c1ebb0f5b97ee048e2191449", "257cc2334d6b256112706aec2ae6664b110c08f2ff29a5f1ed6a2c2f1ff9b72d", "c721d5c04344b35d96fcd1540cae7bb5b116d5623947e036f0ffe6f58405822d", 
"eeef45c955cbeb581c7ada3817ef9b8a6e259a72f906e0964686f890168c271c", "fe1411fb3f8eacfaca48f905f2b2458a0ba9fba30f0dee3b22d507216e21d9ed", "ef9d7e8a9c7a2154c9528d072cdb4810d36adbb4e52d1db1aa1c157433ca68a0",
"c33d0a591adaa8b789cbaa047acc541cf22625523d2144979e41d6c33ce932be", "92d7aaa10819560ad0b1896b1f20d76e4794aa848428234962a75900b5350c21", "e5f043d25b75bd3c8b5d866671dc48cfcdaae62715cb3417baeea3661da67e8d",
"09336624da3703d05abc091e0e03f9d32c5f08b83348a8c875fdee0ede253052", "5a0dd2a7f51cfa96d2cd7ae1db32dfc2e00ef31c6c4dbed69944dfa16bcfb32f", "7023d5a549fc0287132d74745a210b72e211e039208548315edffe6c6cbb7856",
"687989c96f4219eb91fafb55edf75e73754f03688f12cdfb8f669396a3a35641", "ad3ce10d464456df7335cc005a63fa950d452edc4d437a2224e9adcee8cfdb99", "3f444d7f97945cff1ab670c57efcc052883e3c4fb6e26fe54e112f7d32d5aa49",
"b61a27d1ed9abec2ff6dc5c68545716b04657b97ec6595cbd9249c2141d69b8d", "3326059a1fd8d489b374a75a31252fb404deb8af139aa6446493398da425a218", "34c5014028e0a9695b39a29b8c009824a4d55b640d7674baa6862c2aa2e7fbfd",
"b3e726290ff76d69e651789ae79b26a036b46e31112f00032cc3bc98f0ef0b94", "778de5026f6d839cf17802cddfb2b59f55d6be65eabbef5e50cf7ebd7a791cc2", "b0c4cc2f29b712e3e28eb250435a46b9d53fafc5904ffe04d335dd19714b2c30",
"38cc4da094f7fabfc2290e5471df857c3217cce95f2ef32aabf3f03cc86c0b82", "3233aad2ce36676a3874f63abf856ab01309b04b89831329c7f1b7e7c34eeea0", "539030ba62c5db5349977264cc1d63e3c1e62e5c685a0ab8c740479e51be1c16",
"ffce2c69ed7c0e5b6cc438f351767ebc4a283333eb61ccde44c656266ae07072", "427c94940cbc1115808536b8ea393466f2eb927d258eda97ddd7308088f0b947", "25875641280a0d75e1d08e49e670f53f27e8972d1d1fac5c45f90e36c23d6a54",
"930bdf0ffb04bd9af589068ac1b3041e7019b6c35d6ab4f6464b51a819c961cd", "251da72de00e7bbc6e2d8f9e430fa7ca3b868274c9225bfc429d3e96100057ba", "b59c470831c149257b8d4596ceb7a85d0655197e6f0284bfcc52e87875d399dc", 
"fb902b8a002fce409b71c06b0e6feb589bbdce47265d1d1116981dba0c556e76", "be223e09accf39789309cad5a640075db34d073de0895d7c9ce5180a37cdf7bf", "27e1be04ba4f62ecbb1f8722803dbe4d9dd3d0a182b22d4ae1f71134c162a8df",
"9ac0452fab8be6f550a6b3d068a5b32d08d597f9461598f4a9a82932f26ba99f", "8e39740d495364c60f745134143247b15e6dd9708e6bbcd317c6e8bfc3a2751b", "fbd9a0fd178c4b134b43398a55d255f329213c09e0c3eec6598bba46f7d5ccff",
"6733e65258b4edde958482553df6758dd2b15a8258f840de1351a1482b61d5bb", "b8adceb66d7b33a8c7165d4724e8876f2f97c196e6ef808251dd98403091fb80", "c05e3c44f63706bf9d99d3f86396504751a1a4756356d987110b739a85ec08a9",
"bfe65a800b71c6b8413038c25dea0d5931eeaa0cd7275003fbb6d2f9523bd493", "6282763ae9810da5ba3bdb9d5908c7bea7688bdb6e9b1501156c6d72a3c91032", "1a82db4070572e38a7f9747c3b36f2916b39d450efefc170e233f40903d7e0e3",
"1a82db4070572e38a7f9747c3b36f2916b39d450efefc170e233f40903d7e0e3", "3310f30347fcb2adeffde572e2bf13c2bab2ca85ee0be9a08fe00db7fd871fdd", "b1f6cdae028a41be01dbb1f9a73e18a88aeb17732483c1b4c65e48bc200fefe1",
"cddd2c01826541b3472c4deae06072b5e977c9ec1a494545ef20149523ffecf5", "1aa1f957c2dc049629840e6e52299e1db736ab999aa112df02b2d2b08209d906", "28a89e558e5be75501c338b0f644c974ead78e942b2fe8e95c7d883b3a70b568",
"0ad86321eee9bad9e3bf9999ab010f68f042dfc18218c2d89e1b69d5626da76c", "2079d06e877aceb21da98cc187c9ba0ee2601a2ddab52974b5133656994c683c", "49ac03619de0e7edf0ee1ef4116b21a4440b1e30eeab5059c130ed07c5c03db3",
"dbccfb68b4f7d5a9df9abb09d0e0b456f45f5bf4f5a70545837f16cc670721db", "c8cdceff0ceac1e907fcb32c4f2bbe0b6b0bf8b1a154add2b4527ae0e2274983", "724d122f57cce585be94b76aaf67b3fd9368cce14e6dd8fb63672f3920f3a695",
"d7e64527e0153a919b0c921051592b4caa0c571c7b724e84d67122d3c1bee6cb", "d408b7d07d1ec3d55fd42cae580ae4450f2bb3d5377c10009b9f8138e1e93a22", "bbddc32b8ec59fb56d857c9fee60087fb667fa79d5eea058556586de5eac878c")

for ($i=0; $i -lt $all_hosts.length; $i++){
    
    if ($hostname -contains $all_hosts[$i]  ) {
        $token = $all_tokens[$i]
        Write-Host $token
    }
}

$MyFileName = "CsUninstallTool.exe"
$filebase = Join-Path $PSScriptRoot $MyFileName

Write-Host $filebase

$arguments = "MAINTENANCE_TOKEN=" + $token + " /quiet"

Start-Process -Wait -FilePath $filebase -ArgumentList $arguments -PassThru

Invoke-Expression "& `"$filebase`" `"$arguments`""

$success = Join-Path $PSScriptRoot "cs_success.txt"

Copy-Item  $success -Destination "C:\"